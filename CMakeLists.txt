
cmake_minimum_required(VERSION 3.25 FATAL_ERROR)
project(libcfunk LANGUAGES C)

set(CMAKE_C_STANDARD 23)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)

# Cache variables required before libcfunk-init.cmake
set(LIBCFUNK_LIBRARY_NAME "cfunk" CACHE STRING "")
set(LIBCFUNK_SOURCE_DIR "${CMAKE_CURRENT_LIST_DIR}/lib" CACHE STRING "")
set(LIBCFUNK_TEST_SOURCE_DIR "${CMAKE_CURRENT_LIST_DIR}/tests" CACHE STRING "")
set(LIBCFUNK_BUILD_DIR "${CMAKE_BINARY_DIR}/lib" CACHE STRING "")
set(LIBCFUNK_TEST_BUILD_DIR "${CMAKE_BINARY_DIR}/tests" CACHE STRING "")
set(LIBCFUNK_MODULE_DIR "${CMAKE_CURRENT_LIST_DIR}/cmake" CACHE STRING "")
set(LIBCFUNK_CONFIG_DIR "${CMAKE_BINARY_DIR}/compat" CACHE STRING "")

include(cmake/libcfunk-init.cmake)

include(cmake/abs.cmake)
include(cmake/accept.cmake)
include(cmake/access.cmake)
include(cmake/alignas.cmake)
include(cmake/_Alignas.cmake)
include(cmake/alignof.cmake)
include(cmake/_Alignof.cmake)
include(cmake/alloca-h.cmake)
include(cmake/alphasort.cmake)
include(cmake/arc4.cmake)
include(cmake/arpa-inet-h.cmake)
include(cmake/assert-h.cmake)
include(cmake/atexit.cmake)
include(cmake/atoi.cmake)
include(cmake/atol.cmake)
include(cmake/atoll.cmake)
include(cmake/attributes.cmake)
include(cmake/base16.cmake)
include(cmake/base32.cmake)
include(cmake/base64.cmake)
include(cmake/bcmp.cmake)
include(cmake/bcopy.cmake)
include(cmake/binary-mode.cmake)
include(cmake/bind.cmake)
include(cmake/block-size.cmake)
include(cmake/bsearch.cmake)
include(cmake/bstree.cmake)
include(cmake/bswap.cmake)
include(cmake/btowc.cmake)
include(cmake/__builtin_expect.cmake)
include(cmake/byteswap-h.cmake)
include(cmake/bzero.cmake)
include(cmake/calloc.cmake)
include(cmake/chdir.cmake)
include(cmake/chmod.cmake)
include(cmake/chown.cmake)
include(cmake/circular-shift.cmake)
include(cmake/close.cmake)
include(cmake/clz.cmake)
include(cmake/connect.cmake)
include(cmake/copy-file.cmake)
include(cmake/copy-file-range.cmake)
include(cmake/copysign.cmake)
include(cmake/copysignf.cmake)
include(cmake/copysignl.cmake)
include(cmake/cpu-count.cmake)
include(cmake/crc32.cmake)
include(cmake/creat.cmake)
include(cmake/ctype.cmake)
include(cmake/ctype-h.cmake)
include(cmake/ctz.cmake)
include(cmake/dirent-h.cmake)
include(cmake/dirfd.cmake)
include(cmake/div.cmake)
include(cmake/dup2.cmake)
include(cmake/dup.cmake)
include(cmake/dysize.cmake)
include(cmake/eaccess.cmake)
include(cmake/endian-h.cmake)
include(cmake/environ.cmake)
include(cmake/err.cmake)
include(cmake/err-h.cmake)
include(cmake/errno-h.cmake)
include(cmake/error.cmake)
include(cmake/error-h.cmake)
include(cmake/euidaccess.cmake)
include(cmake/execl.cmake)
include(cmake/execle.cmake)
include(cmake/execlp.cmake)
include(cmake/execv.cmake)
include(cmake/execvp.cmake)
include(cmake/execvpe.cmake)
include(cmake/_Exit.cmake)
include(cmake/explicit-bzero.cmake)
include(cmake/fabs.cmake)
include(cmake/fabsf.cmake)
include(cmake/fabsl.cmake)
include(cmake/fchdir.cmake)
include(cmake/fcntl.cmake)
include(cmake/fcntl-h.cmake)
include(cmake/fdatasync.cmake)
include(cmake/ffs.cmake)
include(cmake/filename.cmake)
include(cmake/fileno.cmake)
include(cmake/float-h.cmake)
include(cmake/fls.cmake)
include(cmake/free.cmake)
include(cmake/fseeko.cmake)
include(cmake/fstat.cmake)
include(cmake/fsync.cmake)
include(cmake/ftello.cmake)
include(cmake/ftruncate.cmake)
include(cmake/__func__.cmake)
include(cmake/gai-strerror.cmake)
include(cmake/gcd.cmake)
include(cmake/getcwd.cmake)
include(cmake/getdelim.cmake)
include(cmake/getdtablesize.cmake)
include(cmake/getentropy.cmake)
include(cmake/getgroups.cmake)
include(cmake/gethostname.cmake)
include(cmake/getline.cmake)
include(cmake/getloadavg.cmake)
include(cmake/getlogin.cmake)
include(cmake/getlogin-r.cmake)
include(cmake/getpagesize.cmake)
include(cmake/getpeername.cmake)
include(cmake/getrandom.cmake)
include(cmake/getsockname.cmake)
include(cmake/getusershell.cmake)
include(cmake/gmtime-r.cmake)
include(cmake/group-member.cmake)
include(cmake/hash-map.cmake)
include(cmake/imaxabs.cmake)
include(cmake/imaxdiv.cmake)
include(cmake/index.cmake)
include(cmake/inttypes-h.cmake)
include(cmake/isapipe.cmake)
include(cmake/isatty.cmake)
include(cmake/iswalnum.cmake)
include(cmake/iswalpha.cmake)
include(cmake/iswblank.cmake)
include(cmake/iswcntrl.cmake)
include(cmake/iswctype.cmake)
include(cmake/iswdigit.cmake)
include(cmake/iswgraph.cmake)
include(cmake/iswlower.cmake)
include(cmake/iswprint.cmake)
include(cmake/iswpunct.cmake)
include(cmake/iswspace.cmake)
include(cmake/iswupper.cmake)
include(cmake/iswxdigit.cmake)
include(cmake/labs.cmake)
include(cmake/langinfo-h.cmake)
include(cmake/lchown.cmake)
include(cmake/ldiv.cmake)
include(cmake/limits-h.cmake)
include(cmake/list.cmake)
include(cmake/listen.cmake)
include(cmake/llabs.cmake)
include(cmake/lldiv.cmake)
include(cmake/localeconv.cmake)
include(cmake/locale-h.cmake)
include(cmake/localtime-r.cmake)
include(cmake/lseek.cmake)
include(cmake/lstat.cmake)
include(cmake/malloc.cmake)
include(cmake/malloc-h.cmake)
include(cmake/math-h.cmake)
include(cmake/max.cmake)
include(cmake/mblen.cmake)
include(cmake/mbrlen.cmake)
include(cmake/mbrtowc.cmake)
include(cmake/mbstowcs.cmake)
include(cmake/mbtowc.cmake)
include(cmake/md4.cmake)
include(cmake/md5.cmake)
include(cmake/memchr.cmake)
include(cmake/memcmp.cmake)
include(cmake/memcpy.cmake)
include(cmake/memdup.cmake)
include(cmake/memmove.cmake)
include(cmake/mempcpy.cmake)
include(cmake/memrchr.cmake)
include(cmake/memset.cmake)
include(cmake/memset-explicit.cmake)
include(cmake/memxor.cmake)
include(cmake/min.cmake)
include(cmake/mkdir.cmake)
include(cmake/mkdtemp.cmake)
include(cmake/mkfifo.cmake)
include(cmake/mknod.cmake)
include(cmake/mkstemp.cmake)
include(cmake/msvc-compat.cmake)
include(cmake/nanosleep.cmake)
include(cmake/netdb-h.cmake)
include(cmake/netinet-in-h.cmake)
include(cmake/nl-langinfo.cmake)
include(cmake/_Noreturn.cmake)
include(cmake/null-device.cmake)
include(cmake/nullptr.cmake)
include(cmake/offsetof.cmake)
include(cmake/open.cmake)
include(cmake/openssl.cmake)
include(cmake/pclose.cmake)
include(cmake/physical-memory.cmake)
include(cmake/pipe.cmake)
include(cmake/popcount.cmake)
include(cmake/popen.cmake)
include(cmake/program-name.cmake)
include(cmake/pthread-h.cmake)
include(cmake/pty-h.cmake)
include(cmake/rawmemchr.cmake)
include(cmake/rbtree.cmake)
include(cmake/read.cmake)
include(cmake/read-full.cmake)
include(cmake/readlink.cmake)
include(cmake/read-nointr.cmake)
include(cmake/reallocarray.cmake)
include(cmake/realloc.cmake)
include(cmake/reallocf.cmake)
include(cmake/recv.cmake)
include(cmake/recvfrom.cmake)
include(cmake/remove.cmake)
include(cmake/rindex.cmake)
include(cmake/rmdir.cmake)
include(cmake/root-gid.cmake)
include(cmake/root-uid.cmake)
include(cmake/same-file.cmake)
include(cmake/same-inode.cmake)
include(cmake/sched-h.cmake)
include(cmake/sched-yield.cmake)
include(cmake/secure-getenv.cmake)
include(cmake/send.cmake)
include(cmake/sendto.cmake)
include(cmake/sethostname.cmake)
include(cmake/setlocale.cmake)
include(cmake/setsockopt.cmake)
include(cmake/sha1.cmake)
include(cmake/sha256.cmake)
include(cmake/sha512.cmake)
include(cmake/sigabbrev-np.cmake)
include(cmake/sigdescr-np.cmake)
include(cmake/signal-h.cmake)
include(cmake/sleep.cmake)
include(cmake/slist.cmake)
include(cmake/socket.cmake)
include(cmake/sockets.cmake)
include(cmake/splay-tree.cmake)
include(cmake/stat.cmake)
include(cmake/stat-timespec.cmake)
include(cmake/stdbool-h.cmake)
include(cmake/stdint-h.cmake)
include(cmake/stdio-ext-h.cmake)
include(cmake/stdio-h.cmake)
include(cmake/stdlib-h.cmake)
include(cmake/stpcpy.cmake)
include(cmake/str2sig.cmake)
include(cmake/strcasecmp.cmake)
include(cmake/strcat.cmake)
include(cmake/strchr.cmake)
include(cmake/strchrnul.cmake)
include(cmake/strcmp.cmake)
include(cmake/strcspn.cmake)
include(cmake/strdup.cmake)
include(cmake/strerrordesc-np.cmake)
include(cmake/strerrorname-np.cmake)
include(cmake/strerror-r.cmake)
include(cmake/string-h.cmake)
include(cmake/strings-h.cmake)
include(cmake/strlen.cmake)
include(cmake/strmode.cmake)
include(cmake/strncasecmp.cmake)
include(cmake/strncat.cmake)
include(cmake/strncmp.cmake)
include(cmake/strncpy.cmake)
include(cmake/strndup.cmake)
include(cmake/strnlen.cmake)
include(cmake/strpbrk.cmake)
include(cmake/strrchr.cmake)
include(cmake/strsep.cmake)
include(cmake/strspn.cmake)
include(cmake/strstr.cmake)
include(cmake/strtoimax.cmake)
include(cmake/strtol.cmake)
include(cmake/strtoll.cmake)
include(cmake/strtoul.cmake)
include(cmake/strtoull.cmake)
include(cmake/strtoumax.cmake)
include(cmake/strverscmp.cmake)
include(cmake/swab.cmake)
include(cmake/symlink.cmake)
include(cmake/sys-endian-h.cmake)
include(cmake/sysexits-h.cmake)
include(cmake/sys-file-h.cmake)
include(cmake/sys-ioctl-h.cmake)
include(cmake/sys-random-h.cmake)
include(cmake/sys-socket-h.cmake)
include(cmake/sys-stat-h.cmake)
include(cmake/sys-time-h.cmake)
include(cmake/sys-times-h.cmake)
include(cmake/sys-types-h.cmake)
include(cmake/sys-utsname-h.cmake)
include(cmake/sys-wait-h.cmake)
include(cmake/tcgetsid.cmake)
include(cmake/termios-h.cmake)
include(cmake/term-size.cmake)
include(cmake/time-h.cmake)
include(cmake/times.cmake)
include(cmake/timespec-get.cmake)
include(cmake/timingsafe-bcmp.cmake)
include(cmake/towlower.cmake)
include(cmake/towupper.cmake)
include(cmake/ttyname-r.cmake)
include(cmake/tzset.cmake)
include(cmake/uchar-h.cmake)
include(cmake/uname.cmake)
include(cmake/unicode.cmake)
include(cmake/unistd-h.cmake)
include(cmake/unlink.cmake)
include(cmake/unlocked-stdio.cmake)
include(cmake/unlockpt.cmake)
include(cmake/usleep.cmake)
include(cmake/utime-h.cmake)
include(cmake/versionsort.cmake)
include(cmake/waitpid.cmake)
include(cmake/wchar-h.cmake)
include(cmake/wcpcpy.cmake)
include(cmake/wcpncpy.cmake)
include(cmake/wcscasecmp.cmake)
include(cmake/wcscat.cmake)
include(cmake/wcschr.cmake)
include(cmake/wcscmp.cmake)
include(cmake/wcscpy.cmake)
include(cmake/wcscspn.cmake)
include(cmake/wcsdup.cmake)
include(cmake/wcslen.cmake)
include(cmake/wcsncasecmp.cmake)
include(cmake/wcsncat.cmake)
include(cmake/wcsncmp.cmake)
include(cmake/wcsncpy.cmake)
include(cmake/wcsnlen.cmake)
include(cmake/wcspbrk.cmake)
include(cmake/wcsspn.cmake)
include(cmake/wcstombs.cmake)
include(cmake/wcswidth.cmake)
include(cmake/wctomb.cmake)
include(cmake/wctype.cmake)
include(cmake/wctype-h.cmake)
include(cmake/wcwidth.cmake)
include(cmake/wmemchr.cmake)
include(cmake/wmemcmp.cmake)
include(cmake/wmemcpy.cmake)
include(cmake/wmemmove.cmake)
include(cmake/wmempcpy.cmake)
include(cmake/wmemset.cmake)
include(cmake/write.cmake)
include(cmake/write-full.cmake)
include(cmake/write-nointr.cmake)
include(cmake/xmalloc.cmake)

# Not compatible with Windows.
if (UNIX)
  include(cmake/cloexec.cmake)
  include(cmake/daemon.cmake)
  include(cmake/nonblocking.cmake)
  include(cmake/posix-openpt.cmake)

  # FIXME: Add implementation using Windows fileapi.h
  include(cmake/flock.cmake)

  # These two rely on minimal functionality of fcntl which can probably
  # be easily emulated on Windows.
  include(cmake/open-standard-streams.cmake)
  include(cmake/safe-creat.cmake)
  include(cmake/safe-dup.cmake)
  include(cmake/safe-open.cmake)
endif ()

# Don't leave enabled, have portability problems.
# include(cmake/getppidof.cmake)
# include(cmake/getprognameof.cmake)
# include(cmake/int-overflow.cmake)
# include(cmake/timespec-getres.cmake)
# include(cmake/stdckdint-h.cmake)
# include(cmake/__fpurge.cmake)
# include(cmake/__fbufsize.cmake)
# include(cmake/__fseterr.cmake)
# include(cmake/__flbf.cmake)
# include(cmake/__fpending.cmake)
# include(cmake/__freadable.cmake)
# include(cmake/__fwritable.cmake)
# include(cmake/__fwriting.cmake)
# include(cmake/__freading.cmake)

include(cmake/libcfunk-final.cmake)


include_guard(GLOBAL)

# Generate <wchar.h> at libcfunk-final.cmake
set(LIBCFUNK_GENERATE_WCHAR_H "1" CACHE INTERNAL "")

check_include_file("wchar.h" HAVE_WCHAR_H)
check_include_file("wctype.h" HAVE_WCTYPE_H)

# Check for types.
if (HAVE_WCHAR_H OR HAVE_WCTYPE_H)
  if (HAVE_WCHAR_H)
    list(APPEND CMAKE_EXTRA_INCLUDE_FILES "wchar.h")
  endif ()
  if (HAVE_WCTYPE_H)
    list(APPEND CMAKE_EXTRA_INCLUDE_FILES "wctype.h")
  endif ()
  check_type_size("mbstate_t" MBSTATE_T)
  check_type_size("wctype_t" WCTYPE_T)
  check_type_size("wint_t" WINT_T)
  if (HAVE_WCHAR_H)
    list(REMOVE_ITEM CMAKE_EXTRA_INCLUDE_FILES "wchar.h")
  endif ()
  if (HAVE_WCTYPE_H)
    list(REMOVE_ITEM CMAKE_EXTRA_INCLUDE_FILES "wctype.h")
  endif ()
else ()
  set(HAVE_MBSTATE_T "" CACHE INTERNAL "")
  set(HAVE_WCTYPE_T "" CACHE INTERNAL "")
  set(HAVE_WINT_T "" CACHE INTERNAL "")
endif ()

# Only show prototypes for checked functions.
set(LIBCFUNK_DECLARE_BTOWC "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_MBRLEN "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCPCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCPNCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCASECMP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCAT "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCHR "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCMP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSCSPN "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSDUP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSLEN "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSNCASECMP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSNCAT "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSNCMP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSNCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSNLEN "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSPBRK "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSSPN "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCSWIDTH "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WCWIDTH "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMCHR "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMCMP "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMMOVE "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMPCPY "0" CACHE INTERNAL "")
set(LIBCFUNK_DECLARE_WMEMSET "0" CACHE INTERNAL "")

if (LIBCFUNK_ENABLE_TESTS)
  include($CACHE{LIBCFUNK_MODULE_DIR}/test-wchar-h.cmake)
endif ()

